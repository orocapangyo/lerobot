# 설치 가이드

## 시스템 요구사항

### 필수 요구사항
- **Python**: 3.10 이상
- **운영체제**: Linux (Ubuntu 22.04 권장), macOS, Windows (WSL2 권장)
- **GPU**: CUDA 11.8 이상 (학습용, 선택사항)

### 권장 사양
- **GPU**: NVIDIA RTX 30 series 이상 (학습용)
- **RAM**: 16GB 이상
- **저장공간**: 50GB 이상 (데이터셋 포함시)

---

## 빠른 설치

### 1. Python 환경 설정

#### Conda 사용 (권장)
```bash
# Miniforge 또는 Anaconda가 설치되어 있어야 합니다
conda create -y -n lerobot python=3.10
conda activate lerobot
```

#### venv 사용
```bash
python3.10 -m venv lerobot-env
source lerobot-env/bin/activate  # Linux/macOS
# 또는
lerobot-env\Scripts\activate  # Windows
```

### 2. LeRobot 설치

#### 방법 A: PyPI에서 설치 (일반 사용자)
```bash
pip install lerobot
```

#### 방법 B: 소스에서 설치 (개발자)
```bash
git clone https://github.com/huggingface/lerobot.git
cd lerobot
pip install -e .
```

---

## 선택적 의존성 설치

LeRobot은 모듈식으로 설계되어 필요한 기능만 설치할 수 있습니다.

### 시뮬레이션 환경

#### ALOHA 환경
```bash
pip install -e ".[aloha]"
```

#### PushT 환경
```bash
pip install -e ".[pusht]"
```

#### Libero 환경
```bash
pip install -e ".[libero]"
```

#### MetaWorld 환경
```bash
pip install -e ".[metaworld]"
```

### 하드웨어 지원

#### Feetech 모터 (SO-100, SO-101)
```bash
pip install -e ".[feetech]"
```

#### Dynamixel 모터
```bash
pip install -e ".[dynamixel]"
```

#### Intel RealSense 카메라
```bash
pip install -e ".[realsense]"
```

### 특정 로봇

#### Koch 로봇
```bash
pip install -e ".[koch]"
```

#### ALOHA 로봇
```bash
pip install -e ".[aloha-real]"
```

#### SO-100 로봇
```bash
pip install -e ".[so100]"
```

### 전체 기능 설치

모든 기능을 한번에 설치:
```bash
pip install -e ".[all]"
```

---

## 특정 용도별 설치

### 1. 시뮬레이션만 사용 (하드웨어 없음)
```bash
conda create -y -n lerobot python=3.10
conda activate lerobot
pip install lerobot
pip install -e ".[aloha,pusht]"
```

### 2. SO-100 로봇 사용
```bash
conda create -y -n lerobot python=3.10
conda activate lerobot
git clone https://github.com/huggingface/lerobot.git
cd lerobot
pip install -e ".[so100,feetech,realsense]"
```

### 3. 전체 개발 환경
```bash
conda create -y -n lerobot python=3.10
conda activate lerobot
git clone https://github.com/huggingface/lerobot.git
cd lerobot
pip install -e ".[dev,all]"
```

---

## GPU 설정

### CUDA 설치 확인
```bash
python -c "import torch; print(torch.cuda.is_available())"
# True가 출력되어야 함
```

### PyTorch CUDA 버전 확인
```bash
python -c "import torch; print(torch.version.cuda)"
```

### CUDA가 없는 경우
특정 CUDA 버전의 PyTorch 설치:
```bash
# CUDA 11.8
pip install torch==2.2.0 torchvision==0.17.0 --index-url https://download.pytorch.org/whl/cu118

# CUDA 12.1
pip install torch==2.2.0 torchvision==0.17.0 --index-url https://download.pytorch.org/whl/cu121
```

---

## 설치 확인

### 기본 확인
```python
import lerobot
print(lerobot.__version__)

# 사용 가능한 데이터셋 확인
from lerobot import available_datasets
print(f"사용 가능한 데이터셋: {len(available_datasets)}개")

# 사용 가능한 정책 확인
from lerobot import available_policies
print(f"사용 가능한 정책: {list(available_policies)}")

# 사용 가능한 환경 확인
from lerobot import available_envs
print(f"사용 가능한 환경: {list(available_envs)}")
```

### 데이터셋 로드 테스트
```python
from lerobot.datasets import LeRobotDataset

# 작은 데이터셋으로 테스트
dataset = LeRobotDataset("lerobot/pusht")
print(f"데이터셋 크기: {len(dataset)}")
print(f"첫 번째 프레임: {dataset[0].keys()}")
```

### 환경 실행 테스트
```python
from lerobot.envs.factory import make_env

# PushT 환경 테스트
env = make_env("PushT-v0")
observation, info = env.reset()
print(f"관측 공간: {observation.keys()}")

# 랜덤 액션 실행
action = env.action_space.sample()
observation, reward, terminated, truncated, info = env.step(action)
print("환경 실행 성공!")
```

---

## 트러블슈팅

### 문제 1: Import Error - "No module named 'lerobot'"

**원인**: 가상환경이 활성화되지 않았거나 설치가 제대로 되지 않음

**해결**:
```bash
# 가상환경 활성화 확인
which python  # Linux/macOS
where python  # Windows

# 재설치
pip uninstall lerobot
pip install lerobot
```

### 문제 2: CUDA out of memory

**원인**: GPU 메모리 부족

**해결**:
```python
# 배치 크기 줄이기
python -m lerobot.scripts.lerobot_train \
  --policy-name act \
  --dataset-repo-id lerobot/pusht \
  --batch-size 8  # 기본값은 보통 32
```

또는 gradient accumulation 사용:
```bash
--gradient-accumulation-steps 4
```

### 문제 3: ModuleNotFoundError: No module named 'gym_aloha'

**원인**: 선택적 의존성 미설치

**해결**:
```bash
pip install -e ".[aloha]"
```

### 문제 4: 카메라가 인식되지 않음

**원인**: USB 권한 또는 드라이버 문제

**해결**:
```bash
# Linux에서 USB 권한 추가
sudo usermod -a -G dialout $USER
sudo usermod -a -G video $USER

# 재부팅 필요
sudo reboot
```

### 문제 5: 모터가 연결되지 않음

**원인**: 시리얼 포트 권한 문제

**해결**:
```bash
# 포트 확인
python -m lerobot.scripts.lerobot_find_port

# 권한 추가
sudo chmod 666 /dev/ttyUSB0  # 실제 포트로 변경
```

### 문제 6: macOS에서 시뮬레이션 환경 오류

**원인**: MuJoCo 렌더링 이슈

**해결**:
```bash
# MuJoCo 재설치
pip uninstall mujoco
pip install mujoco
```

환경 변수 설정:
```bash
export MUJOCO_GL=egl  # Linux
export MUJOCO_GL=osmesa  # macOS
```

### 문제 7: Windows에서 설치 실패

**권장**: WSL2 (Windows Subsystem for Linux) 사용

```powershell
# PowerShell에서 WSL2 설치
wsl --install
wsl --install -d Ubuntu-22.04

# WSL2에서 LeRobot 설치
wsl
# 이후 Linux 설치 절차 따름
```

---

## 개발 환경 설정

### Pre-commit Hooks 설치
```bash
pip install pre-commit
pre-commit install
```

### 테스트 실행
```bash
# 전체 테스트
pytest tests/

# 특정 테스트만 실행
pytest tests/test_datasets.py

# 커버리지 포함
pytest --cov=lerobot tests/
```

### 코드 스타일 확인
```bash
# Ruff로 린트
ruff check src/

# 자동 수정
ruff check --fix src/

# 포맷팅
ruff format src/
```

---

## HuggingFace Hub 설정

데이터셋 다운로드 및 모델 업로드를 위해 HuggingFace 계정이 필요합니다.

### 1. 계정 생성
[https://huggingface.co/join](https://huggingface.co/join)에서 무료 계정 생성

### 2. 토큰 생성
1. [Settings > Access Tokens](https://huggingface.co/settings/tokens)로 이동
2. "New token" 클릭
3. "Write" 권한 선택 (업로드용)
4. 토큰 복사

### 3. 토큰 설정
```bash
# CLI로 로그인
huggingface-cli login

# 또는 환경 변수 설정
export HF_TOKEN="your_token_here"
```

---

## 다음 단계

설치가 완료되었다면:

1. [빠른 시작](02-빠른-시작.md)으로 첫 실습 진행
2. [첫 번째 모델 훈련](../04-tutorials/60-첫-모델-훈련.md) 튜토리얼 시작
3. [데이터셋 시각화](../04-tutorials/64-데이터셋-시각화.md)로 데이터 탐색

---

**참조 파일:**
- [README.md](../../../README.md) - Installation 섹션
- [pyproject.toml](../../../pyproject.toml) - 의존성 정의
- [requirements-ubuntu.txt](../../../requirements-ubuntu.txt)
- [requirements-macos.txt](../../../requirements-macos.txt)
